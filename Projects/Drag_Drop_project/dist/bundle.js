(()=>{"use strict";class e{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class t extends e{constructor(){super(),this.projects=[]}addProject(e){this.projects.push(e);for(const e of this.listeners)e(this.projects.slice())}moveProject(e,t){const n=this.projects.find((t=>t.Id===e));console.log("Project: ",n),n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}static getInstance(){return this.instance||(this.instance=new t),this.instance}}const n=t.getInstance();class r{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}var s;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(s||(s={}));class i{constructor(e,t,n,r,s){this.title=t,this.description=n,this.people=r,this.status=s,this.id=e}get Id(){return this.id}}function o(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),e.minLength&&"string"==typeof e.value&&(t=t&&e.value.toString().trim().length>=e.minLength),e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.toString().trim().length<e.maxLength),e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),e.max&&"number"==typeof e.value&&(t=t&&e.value<e.max),t}function l(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}class a extends r{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}gatherUserInput(){console.log("GATHERING");const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0},l={value:n,required:!0};return o({value:e,required:!0})&&o(r)&&o(l)?new i(Math.random().toString(),e,t,+n,s.Active):void alert("Invalid Input, Please Try Again !")}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();t&&(n.addProject(t),this.clearInputs())}}!function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);i>3&&o&&Object.defineProperty(t,n,o)}([l],a.prototype,"submitHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class d extends r{get persons(){return 1===this._project.people?"1 person":`${this._project.people} persons`}constructor(e,t){super("single-project",e,!1,t.Id),this._project=t,this.configure(),this.renderContent()}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this._project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this._project.description}dragStartHandler(e){e.dataTransfer.setData("text/plain",this._project.Id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}}c([l],d.prototype,"dragStartHandler",null),c([l],d.prototype,"dragEndHandler",null);var p=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class u extends r{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new d(this.element.querySelector("ul").id,e)}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");n.moveProject(t,"active"===this.type?s.Active:s.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),n.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===s.Active:e.status===s.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+"PROJECTS"}}p([l],u.prototype,"dragOverHandler",null),p([l],u.prototype,"dropHandler",null),p([l],u.prototype,"dragLeaveHandler",null),new a,new u("active"),new u("finished")})();